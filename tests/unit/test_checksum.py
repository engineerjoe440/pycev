
################################################################################
"""PyCEV Tests - Validate Checksum Functionality."""
################################################################################
# pylint: disable=unused-import, import-error, import-outside-toplevel

import sys
from pathlib import Path

sys.path.insert(0, str(Path(__file__).parent.parent.parent))

from pycev import row_wise_checksum

EXAMPLE = '''"IA","IB","IC","IN","IG","VAY(kV)","VBY(kV)","VCY(kV)","VAZ(kV)","VBZ(kV)","VCZ(kV)","FREQ","TRIG","EN TRIPLED * * * * * * TLED_08 TLED_07 TLED_06 TLED_05 TLED_04 TLED_03 TLED_02 TLED_01 TLED_16 TLED_15 TLED_14 TLED_13 TLED_12 TLED_11 TLED_10 TLED_09 TLED_24 TLED_23 TLED_22 TLED_21 TLED_20 TLED_19 TLED_18 TLED_17 50A1 50B1 50C1 50P1 50A2 50B2 50C2 50P2 50A3 50B3 50C3 50P3 50A4 50B4 50C4 50P4 50G1 50G2 50G3 50G4 50Q1 50Q2 50Q3 50Q4 50N1 50N2 50N3 50N4 50A 50B 50C 50P32 50P5 50P6 50G5 50G6 50Q5 50Q6 50N5 50N6 50LA 50LB 50LC 50L 50GF 50GR 50QF 50QR 51AS 51AR 51A 51AT 51BS 51BR 51B 51BT 51CS 51CR 51C 51CT 51PS 51PR 51P 51PT 51G1S 51G1R 51G1 51G1T 51G2S 51G2R 51G2 51G2T 51QS 51QR 51Q 51QT 51N1S 51N1R 51N1 51N1T 50A1T 50B1T 50C1T 50P1T 50A2T 50B2T 50C2T 50P2T 50A3T 50B3T 50C3T 50P3T 50A4T 50B4T 50C4T 50P4T 50G1T 50G2T 50G3T 50G4T 50Q1T 50Q2T 50Q3T 50Q4T 50N1T 50N2T 50N3T 50N4T 51N2S 51N2R 51N2 51N2T 52AA 52AB 52AC 52A3P SPOA SPOB SPOC SPO V1GOOD LOP VPOLV GNDSW DD SPE SW1 3PO FSA FSB FSC * PHASE_A PHASE_B PHASE_C * ZLOUT ZLIN ZLOAD * FAULT * * * 27YA1 27YB1 27YC1 27YA2 27YB2 27YC2 59YA1 59YB1 59YC1 59YA2 59YB2 59YC2 27YAB1 27YBC1 27YCA1 59YAB1 59YBC1 59YCA1 59YN1 59YN2 59YQ1 59YV1 3P27Y 3P59Y * * * * * * * VSELY 27ZA1 27ZB1 27ZC1 27ZA2 27ZB2 27ZC2 59ZA1 59ZB1 59ZC1 59ZA2 59ZB2 59ZC2 27ZAB1 27ZBC1 27ZCA1 59ZAB1 59ZBC1 59ZCA1 59ZN1 59ZN2 59ZQ1 59ZV1 3P27Z 3P59Z * * * * * * * VSELZ SF 25A1 25A2 SFAST SSLOW * 59VS 59VP 81D1 81D2 81D3 81D4 81D5 81D6 FREQOK * 81D1T 81D2T 81D3T 81D4T 81D5T 81D6T 27B81 * * IN107 IN106 IN105 IN104 IN103 IN102 IN101 * * IN206 IN205 IN204 IN203 IN202 IN201 * * * 81R4T 81R3T 81R2T 81R1T 81RT * * PB06_LED PB05_LED PB04_LED PB03_LED PB02_LED PB01_LED * * PB12_LED PB11_LED PB10_LED PB09_LED PB08_LED PB07_LED PWR_SRC1 * * CHRGG DISCHG DTFAIL BTFAIL TOSLP * TCCAP XS_TRIP1 XS_TRIP2 XS_TRIP3 XS_CLOS1 XS_CLOS2 XS_CLOS3 LB01 LB02 LB03 LB04 LB05 LB06 LB07 LB08 LB09 LB10 LB11 LB12 LB13 LB14 LB15 LB16 CCA CCB CCC CC3 OCA OCB OCC OC3 SOTFE SOTFT TRGTR * TRIPA TRIPB TRIPC TRIP3P LT01 LT02 LT03 LT04 LT05 LT06 LT07 LT08 LT09 LT10 LT11 LT12 LT13 LT14 LT15 LT16 LT17 LT18 LT19 LT20 LT21 LT22 LT23 LT24 LT25 LT26 LT27 LT28 LT29 LT30 LT31 LT32 SV01 SV02 SV03 SV04 SV01T SV02T SV03T SV04T SV05 SV06 SV07 SV08 SV05T SV06T SV07T SV08T SV09 SV10 SV11 SV12 SV09T SV10T SV11T SV12T SV13 SV14 SV15 SV16 SV13T SV14T SV15T SV16T SV17 SV18 SV19 SV20 SV17T SV18T SV19T SV20T SV21 SV22 SV23 SV24 SV21T SV22T SV23T SV24T SV25 SV26 SV27 SV28 SV25T SV26T SV27T SV28T SV29 SV30 SV31 SV32 SV29T SV30T SV31T SV32T SV33 SV34 SV35 SV36 SV33T SV34T SV35T SV36T SV37 SV38 SV39 SV40 SV37T SV38T SV39T SV40T SV41 SV42 SV43 SV44 SV41T SV42T SV43T SV44T SV45 SV46 SV47 SV48 SV45T SV46T SV47T SV48T SC01QU SC02QU SC03QU SC04QU SC05QU SC06QU SC07QU SC08QU SC01QD SC02QD SC03QD SC04QD SC05QD SC06QD SC07QD SC08QD SC09QU SC10QU SC11QU SC12QU SC13QU SC14QU SC15QU SC16QU SC09QD SC10QD SC11QD SC12QD SC13QD SC14QD SC15QD SC16QD 79RS3P 79CY3P 79LO3P SH03P SH13P SH23P SH33P SH43P 79RSA 79CYA 79LOA SH0A SH1A SH2A SH3A SH4A 79RSB 79CYB 79LOB SH0B SH1B SH2B SH3B SH4B 79RSC 79CYC 79LOC SH0C SH1C SH2C SH3C SH4C CLOSEA CLOSEB CLOSEC CLOSE3P CFA CFB CFC CF3P RCSFA RCSFB RCSFC RCSF3P OPTMNA OPTMNB OPTMNC OPTMN3P RSTMNA RSTMNB RSTMNC RSTMN3P ULCLA ULCLB ULCLC ULCL3P 32QE 32QGE 32VE * F32Q R32Q F32QG R32QG F32V R32V F32P R32P * * * * 32QF 32QR 32GF 32GR 32PF 32PR * * BCWA BCWB BCWC BCW PDEM NDEM GDEM QDEM OUT108 OUT107 OUT106 OUT105 OUT104 OUT103 OUT102 OUT101 OUT202 OUT201 RCCL3X RCTR3X RCCL2X RCTR2X RCCL1X RCTR1X * * * * * * * * SG1 SG2 SG3 SG4 SG5 SG6 SG7 SG8 * * * IRIGOK INMET ICMET IBMET IAMET RMB8A RMB7A RMB6A RMB5A RMB4A RMB3A RMB2A RMB1A TMB8A TMB7A TMB6A TMB5A TMB4A TMB3A TMB2A TMB1A RMB8B RMB7B RMB6B RMB5B RMB4B RMB3B RMB2B RMB1B TMB8B TMB7B TMB6B TMB5B TMB4B TMB3B TMB2B TMB1B LBOKA CBADA RBADA ROKA LBOKB CBADB RBADB ROKB SAGA SAGB SAGC SAG3P SWA SWB SWC SW3P * * * * * * * * INTA INTB INTC INT3P * * * TESTDB * * * 3PWR1 * * * 3PWR2 * * * 3PWR3 * * * 3PWR4 * * PB06 PB05 PB04 PB03 PB02 PB01 * * PB06_PUL PB05_PUL PB04_PUL PB03_PUL PB02_PUL PB01_PUL * * PB12 PB11 PB10 PB09 PB08 PB07 * * PB12_PUL PB11_PUL PB10_PUL PB09_PUL PB08_PUL PB07_PUL RB01 RB02 RB03 RB04 RB05 RB06 RB07 RB08 RB09 RB10 RB11 RB12 RB13 RB14 RB15 RB16 RB17 RB18 RB19 RB20 RB21 RB22 RB23 RB24 RB25 RB26 RB27 RB28 RB29 RB30 RB31 RB32 RSTTRGT RST_MML RST_ENE RST_HIS RST_BK RST_PDM RST_DEM RST_HAL * LINK5A LINK5B LNKFAIL P5ASEL P5BSEL TSNTPP TSNTPB SV49 SV50 SV51 SV52 SV49T SV50T SV51T SV52T SV53 SV54 SV55 SV56 SV53T SV54T SV55T SV56T SV57 SV58 SV59 SV60 SV57T SV58T SV59T SV60T SV61 SV62 SV63 SV64 SV61T SV62T SV63T SV64T DST DSTP LPSEC LPSECP TQUAL4 TQUAL3 TQUAL2 TQUAL1 TSOK TIRIG PMDOK PMTRIG TREA4 TREA3 TREA2 TREA1 SALARM ACCESS * * HALARMA HALARMP HALARML HALARM * * PASNVAL ACCESSP GRPSW SETCHG CHGPASS BADPASS * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * HBL2AT HBL2BT HBL2CT HBL2T * * * * A1_CFG A2_CFG * * * * * 69_YH * * * * * * * RSTDNPE ","C051"'''
EXPECTATION = '''"IA","IB","IC","IN","IG","VAY(kV)","VBY(kV)","VCY(kV)","VAZ(kV)","VBZ(kV)","VCZ(kV)","FREQ","TRIG","EN TRIPLED * * * * * * TLED_08 TLED_07 TLED_06 TLED_05 TLED_04 TLED_03 TLED_02 TLED_01 TLED_16 TLED_15 TLED_14 TLED_13 TLED_12 TLED_11 TLED_10 TLED_09 TLED_24 TLED_23 TLED_22 TLED_21 TLED_20 TLED_19 TLED_18 TLED_17 50A1 50B1 50C1 50P1 50A2 50B2 50C2 50P2 50A3 50B3 50C3 50P3 50A4 50B4 50C4 50P4 50G1 50G2 50G3 50G4 50Q1 50Q2 50Q3 50Q4 50N1 50N2 50N3 50N4 50A 50B 50C 50P32 50P5 50P6 50G5 50G6 50Q5 50Q6 50N5 50N6 50LA 50LB 50LC 50L 50GF 50GR 50QF 50QR 51AS 51AR 51A 51AT 51BS 51BR 51B 51BT 51CS 51CR 51C 51CT 51PS 51PR 51P 51PT 51G1S 51G1R 51G1 51G1T 51G2S 51G2R 51G2 51G2T 51QS 51QR 51Q 51QT 51N1S 51N1R 51N1 51N1T 50A1T 50B1T 50C1T 50P1T 50A2T 50B2T 50C2T 50P2T 50A3T 50B3T 50C3T 50P3T 50A4T 50B4T 50C4T 50P4T 50G1T 50G2T 50G3T 50G4T 50Q1T 50Q2T 50Q3T 50Q4T 50N1T 50N2T 50N3T 50N4T 51N2S 51N2R 51N2 51N2T 52AA 52AB 52AC 52A3P SPOA SPOB SPOC SPO V1GOOD LOP VPOLV GNDSW DD SPE SW1 3PO FSA FSB FSC * PHASE_A PHASE_B PHASE_C * ZLOUT ZLIN ZLOAD * FAULT * * * 27YA1 27YB1 27YC1 27YA2 27YB2 27YC2 59YA1 59YB1 59YC1 59YA2 59YB2 59YC2 27YAB1 27YBC1 27YCA1 59YAB1 59YBC1 59YCA1 59YN1 59YN2 59YQ1 59YV1 3P27Y 3P59Y * * * * * * * VSELY 27ZA1 27ZB1 27ZC1 27ZA2 27ZB2 27ZC2 59ZA1 59ZB1 59ZC1 59ZA2 59ZB2 59ZC2 27ZAB1 27ZBC1 27ZCA1 59ZAB1 59ZBC1 59ZCA1 59ZN1 59ZN2 59ZQ1 59ZV1 3P27Z 3P59Z * * * * * * * VSELZ SF 25A1 25A2 SFAST SSLOW * 59VS 59VP 81D1 81D2 81D3 81D4 81D5 81D6 FREQOK * 81D1T 81D2T 81D3T 81D4T 81D5T 81D6T 27B81 * * IN107 IN106 IN105 IN104 IN103 IN102 IN101 * * IN206 IN205 IN204 IN203 IN202 IN201 * * * 81R4T 81R3T 81R2T 81R1T 81RT * * PB06_LED PB05_LED PB04_LED PB03_LED PB02_LED PB01_LED * * PB12_LED PB11_LED PB10_LED PB09_LED PB08_LED PB07_LED PWR_SRC1 * * CHRGG DISCHG DTFAIL BTFAIL TOSLP * TCCAP XS_TRIP1 XS_TRIP2 XS_TRIP3 XS_CLOS1 XS_CLOS2 XS_CLOS3 LB01 LB02 LB03 LB04 LB05 LB06 LB07 LB08 LB09 LB10 LB11 LB12 LB13 LB14 LB15 LB16 CCA CCB CCC CC3 OCA OCB OCC OC3 SOTFE SOTFT TRGTR * TRIPA TRIPB TRIPC TRIP3P LT01 LT02 LT03 LT04 LT05 LT06 LT07 LT08 LT09 LT10 LT11 LT12 LT13 LT14 LT15 LT16 LT17 LT18 LT19 LT20 LT21 LT22 LT23 LT24 LT25 LT26 LT27 LT28 LT29 LT30 LT31 LT32 SV01 SV02 SV03 SV04 SV01T SV02T SV03T SV04T SV05 SV06 SV07 SV08 SV05T SV06T SV07T SV08T SV09 SV10 SV11 SV12 SV09T SV10T SV11T SV12T SV13 SV14 SV15 SV16 SV13T SV14T SV15T SV16T SV17 SV18 SV19 SV20 SV17T SV18T SV19T SV20T SV21 SV22 SV23 SV24 SV21T SV22T SV23T SV24T SV25 SV26 SV27 SV28 SV25T SV26T SV27T SV28T SV29 SV30 SV31 SV32 SV29T SV30T SV31T SV32T SV33 SV34 SV35 SV36 SV33T SV34T SV35T SV36T SV37 SV38 SV39 SV40 SV37T SV38T SV39T SV40T SV41 SV42 SV43 SV44 SV41T SV42T SV43T SV44T SV45 SV46 SV47 SV48 SV45T SV46T SV47T SV48T SC01QU SC02QU SC03QU SC04QU SC05QU SC06QU SC07QU SC08QU SC01QD SC02QD SC03QD SC04QD SC05QD SC06QD SC07QD SC08QD SC09QU SC10QU SC11QU SC12QU SC13QU SC14QU SC15QU SC16QU SC09QD SC10QD SC11QD SC12QD SC13QD SC14QD SC15QD SC16QD 79RS3P 79CY3P 79LO3P SH03P SH13P SH23P SH33P SH43P 79RSA 79CYA 79LOA SH0A SH1A SH2A SH3A SH4A 79RSB 79CYB 79LOB SH0B SH1B SH2B SH3B SH4B 79RSC 79CYC 79LOC SH0C SH1C SH2C SH3C SH4C CLOSEA CLOSEB CLOSEC CLOSE3P CFA CFB CFC CF3P RCSFA RCSFB RCSFC RCSF3P OPTMNA OPTMNB OPTMNC OPTMN3P RSTMNA RSTMNB RSTMNC RSTMN3P ULCLA ULCLB ULCLC ULCL3P 32QE 32QGE 32VE * F32Q R32Q F32QG R32QG F32V R32V F32P R32P * * * * 32QF 32QR 32GF 32GR 32PF 32PR * * BCWA BCWB BCWC BCW PDEM NDEM GDEM QDEM OUT108 OUT107 OUT106 OUT105 OUT104 OUT103 OUT102 OUT101 OUT202 OUT201 RCCL3X RCTR3X RCCL2X RCTR2X RCCL1X RCTR1X * * * * * * * * SG1 SG2 SG3 SG4 SG5 SG6 SG7 SG8 * * * IRIGOK INMET ICMET IBMET IAMET RMB8A RMB7A RMB6A RMB5A RMB4A RMB3A RMB2A RMB1A TMB8A TMB7A TMB6A TMB5A TMB4A TMB3A TMB2A TMB1A RMB8B RMB7B RMB6B RMB5B RMB4B RMB3B RMB2B RMB1B TMB8B TMB7B TMB6B TMB5B TMB4B TMB3B TMB2B TMB1B LBOKA CBADA RBADA ROKA LBOKB CBADB RBADB ROKB SAGA SAGB SAGC SAG3P SWA SWB SWC SW3P * * * * * * * * INTA INTB INTC INT3P * * * TESTDB * * * 3PWR1 * * * 3PWR2 * * * 3PWR3 * * * 3PWR4 * * PB06 PB05 PB04 PB03 PB02 PB01 * * PB06_PUL PB05_PUL PB04_PUL PB03_PUL PB02_PUL PB01_PUL * * PB12 PB11 PB10 PB09 PB08 PB07 * * PB12_PUL PB11_PUL PB10_PUL PB09_PUL PB08_PUL PB07_PUL RB01 RB02 RB03 RB04 RB05 RB06 RB07 RB08 RB09 RB10 RB11 RB12 RB13 RB14 RB15 RB16 RB17 RB18 RB19 RB20 RB21 RB22 RB23 RB24 RB25 RB26 RB27 RB28 RB29 RB30 RB31 RB32 RSTTRGT RST_MML RST_ENE RST_HIS RST_BK RST_PDM RST_DEM RST_HAL * LINK5A LINK5B LNKFAIL P5ASEL P5BSEL TSNTPP TSNTPB SV49 SV50 SV51 SV52 SV49T SV50T SV51T SV52T SV53 SV54 SV55 SV56 SV53T SV54T SV55T SV56T SV57 SV58 SV59 SV60 SV57T SV58T SV59T SV60T SV61 SV62 SV63 SV64 SV61T SV62T SV63T SV64T DST DSTP LPSEC LPSECP TQUAL4 TQUAL3 TQUAL2 TQUAL1 TSOK TIRIG PMDOK PMTRIG TREA4 TREA3 TREA2 TREA1 SALARM ACCESS * * HALARMA HALARMP HALARML HALARM * * PASNVAL ACCESSP GRPSW SETCHG CHGPASS BADPASS * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * HBL2AT HBL2BT HBL2CT HBL2T * * * * A1_CFG A2_CFG * * * * * 69_YH * * * * * * * RSTDNPE "'''

def test_checksum():
    """Validate Checksum Functionality Works for String in Question."""
    content, validity = row_wise_checksum(EXAMPLE)
    assert validity
    assert content == EXPECTATION
